# CSS工程化

## 概述

有关CSS的现状可以参考 https://stateofcss.com/，其中包含每个年份的调查情况（从2019开始）

### css的问题

1. 类名冲突的问题

   当你写一个css类的时候，你是写全局的类呢，还是写多个层级选择后的类呢？

   你会发现，怎么都不好

   - 过深的层级不利于编写、阅读、压缩、复用
   - 过浅的层级容易导致类名冲突

   一旦样式多起来，这个问题就会变得越发严重，其实归根结底，就是类名冲突不好解决的问题

2. 重复样式

   这种问题就更普遍了，一些重复的样式值总是不断的出现在css代码中，维护起来极其困难

   比如，一个网站的颜色一般就那么几种：

   - primary
   - info
   - warn
   - error
   - success

   如果有更多的颜色，都是从这些色调中自然变化得来，可以想象，这些颜色会到处充斥到诸如背景、文字、边框中，一旦要做颜色调整，是一个非常大的工程

3. css文件细分

   在大型项目中，css也需要更细的拆分，这样有利于css代码的维护。

   比如，有一个做轮播图的模块，它不仅需要依赖js功能，还需要依赖css样式，既然依赖的js功能仅关心轮播图，那css样式也应该仅关心轮播图，由此类推，不同的功能依赖不同的css样式、公共样式可以单独抽离，这样就形成了不同于过去的css文件结构：文件更多、拆分的更细

   而同时，在真实的运行环境下，我们却希望文件越少越好，这种情况和JS遇到的情况是一致的

   因此，对于css，也需要工程化管理

   从另一个角度来说，css的工程化会遇到更多的挑战，因为css不像JS，它的语法本身经过这么多年并没有发生多少的变化（css3也仅仅是多了一些属性而已），对于css语法本身的改变也是一个工程化的课题

### 解决

1. 命名冲突的问题

   * 命名约定

     提供一个命名标准，来解决冲突，常用的标准（都是民间的，官方不解决）有：

     * [BEM](https://getbem.com/)

       全称"Block Element Modifier"，也就是"块，元素，修饰符"，它的核心思想是 **通过组件名的唯一性来保证选择器的唯一性，从而保证样式不会污染到组件外**。

       ```html
       <-- 示例 -->
       <nav class="nav"> 
           <ul class="nav__list"> 
               <li class="nav__item nav__item--active"> 
                   <a href="/about" class="nav__link">About</a> 
               </li> 
               <li class="nav__item"> 
                   <a href="/pricing" class="nav__link">Pricing</a> 
               </li> 
               <li class="nav__item"> 
                   <a href="/contact" class="nav__link">Contact</a> 
               </li> 
           </ul> 
       </nav>
       ```
   
       1. **区块 / Block：** 代表页面中独立且可复用的底层组件。
       2. **元素 / Element：** Block 内部的组成元素，通常用于定义块的内部结构和样式。就像是各种家具、装饰品等，它们的存在才让一个空间与众不同。
       3. **修饰符 / Modifier：** 用于改变 Block 或 Element 的外观和行为。比如灯有打开和关闭两种状态，“开”和“闭”就是“灯”这个元素的修饰符。
   
     * OOCSS
   
       全称"Object-Oriented CSS"，也就是"面向对象CSS"，主要是通过抽象将CSS进行模块化，提高代码的复用性和可维护性。
   
       可以参考这篇文章：[CSS 架构之OOCSS](https://juejin.cn/post/7021067874139635726)
   
       其实在平常开发中，我们也会不知不觉的用上这种方式，只是不知道它叫"OOCSS":
   
       示例 =>
   
       ```html
       <!DOCTYPE html>
       <html lang="en">
         <head>
           <meta charset="UTF-8" />
           <meta name="viewport" content="width=device-width, initial-scale=1.0" />
           <title>Document</title>
           <style>
             .box-border {
               border: 1px dashed #ccc;
               border-radius: 6px;
             }
       
             .box-1 {
               width: 100px;
               height: 100px;
             }
       
             .box-2 {
               width: 120px;
               height: 120px;
             }
           </style>
         </head>
         <body>
           <div class="box-border box-1"></div>
           <div class="box-border box-2"></div>
         </body>
       </html>
       ```
   
     * [SMACSS](https://smacss.com/) 网友翻译的中文站点：[SMACSS-ZH](https://smacss-zh.vercel.app/)
   
       全称"Scalable and Modular Architecture for CSS"，就是"CSS的可扩展和模块化架构"。
   
       可以参考这篇文章：[CSS 架构之 SMACSS](https://juejin.cn/post/7021803661890174989)
   
       它把CSS拆成五个部分：base（基础）、layout（布局）、module（模块）、state（状态）、theme（主题）。
   
       `base`：定义全局性初始化默认样式，比如说：reset.css（统一重置浏览器部分的默认样式）
   
       `layout`：定义了页面的主要布局结构，例如头部、主内容区和页脚等，用于定义页面的主要区域，而这类的css命名通常以`.l-`开头
   
       `module`：定义了可复用的独立组件样式，通常是定义局部的特定组件样式。
   
       `state`：定义了不同状态下的样式变化，例如悬停、激活等。状态样式通常是动态的，用于描述组件在不同状态下的样式，而这类的css命名通常以`.is-`来开头。
   
       `theme`：主题样式定义了不同主题的样式变化，例如深色主题、浅色主题等，主题样式往往是全局的，用于定义整个网站的主题样式。特殊情况下，组件库中每种按钮都有一种主题（primary, info, success等等），但它是局部的，所以要以实际的场景思考。
   
     * ACSS
   
       全称"Atomic CSS"，也叫"原子化 CSS"，它的核心思想是：不强调**逻辑**，而更侧重表现的一门**所见即所得**的语言，将 CSS 属性写成一个独立的类名。
   
       可以参考这篇文章：[CSS 架构之 ACSS](https://juejin.cn/post/7024007157221687304)
   
       示例：
   
       ```HTML
       <!DOCTYPE html>
       <html lang="en">
         <head>
           <meta charset="UTF-8" />
           <meta name="viewport" content="width=device-width, initial-scale=1.0" />
           <title>Document</title>
           <style>
             .w-120px {
               width: 120px;
             }
       
             .h-120px {
               height: 120px;
             }
       
             .text-center {
               text-align: center;
             }
       
             .leading-8 {
               line-height: 2rem;
             }
       
             .ml-10 {
               margin-left: 10px;
             }
       
             .border-2 {
               border-width: 2px;
             }
       
             .border-dashed {
               border-style: dashed;
             }
       
             .border-red-200 {
               border-color: rgb(254 202 202);
             }
           </style>
         </head>
         <body>
           <div
             class="w-120px h-120px text-center leading-8 ml-10 border-2 border-dashed border-red-200"
           >
             Hello world!
           </div>
         </body>
       </html>
       
       ```
   
       实际情况下，每个CSS 属性作为一个类名不可能全部自己手写，所以会借助第三方“原子化框架”，著名的有: [tailwindcss](https://www.tailwindcss.cn/)、[unocss](https://unocss.nodejs.cn/)，使用这种css命名规范开发效率会变得更快，也会很少写新的css，灵活，易读，永远不用担心命名冲突，永远不用担心样式覆盖。但是劣势在于需要一定的学习成本，HTML体积会变大
   
     等等。
   
     下面这是2020年受欢迎的CSS方法论（在后面年份的CSS调查中没有统计）：
   
     ![CSS方法论统计](./../.images/chapter-3/00_01.png)
   
   * `css in js`
   
   * `css module`

